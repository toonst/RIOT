APPLICATION = driver_mcp2515
include ../Makefile.tests_common

FEATURES_REQUIRED = periph_gpio periph_gpio_irq periph_spi

USEMODULE += shell
USEMODULE += can
# USEMODULE += auto_init_can
USEMODULE += mcp2515
USEMODULE += atmega_pcint1

# set device parameters to override defaults
TEST_MCP2515_SPI   ?= SPI_DEV\(0\)
TEST_MCP2515_SPI_CLK   ?= SPI_CLK_1MHZ
TEST_MCP2515_SPI_MODE   ?= SPI_MODE_0
TEST_MCP2515_CS    ?= GPIO_PIN\(PORT_B,4\)
TEST_MCP2515_RESET ?= GPIO_PIN\(PORT_B,2\)
TEST_MCP2515_INT ?= GPIO_PIN\(PORT_B,3\)
TEST_MCP2515_CLK ?=\(8000000ul\)
TEST_MCP2515_BITRATE ?= \(125000\)

# export parameters
CFLAGS += -DTEST_MCP2515_SPI=$(TEST_MCP2515_SPI)
CFLAGS += -DTEST_MCP2515_SPI_MODE=$(TEST_MCP2515_SPI_MODE)
CFLAGS += -DTEST_MCP2515_SPI_CLK=$(TEST_MCP2515_SPI_CLK)
CFLAGS += -DTEST_MCP2515_CS=$(TEST_MCP2515_CS)
CFLAGS += -DTEST_MCP2515_RESET=$(TEST_MCP2515_RESET)
CFLAGS += -DTEST_MCP2515_INT=$(TEST_MCP2515_INT)
CFLAGS += -DTEST_MCP2515_CLK=$(TEST_MCP2515_CLK)
CFLAGS += -DCANDEV_MCP2515_DEFAULT_BITRATE=$(TEST_MCP2515_BITRATE)

include $(RIOTBASE)/Makefile.include
